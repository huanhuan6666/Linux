# 高级IO
## 非阻塞IO与有限状态机编程
### 阻塞IO和非阻塞IO
* 阻塞IO：当发起系统调用IO后若内核缓冲区无数据，进程(线程)阻塞在IO操作上，并且**让出CPU**，知道数据就绪后**内核**将数据拷贝到用户线程，用户线程才解除阻塞状态。

* 非阻塞IO：当进程发起系统调用IO后，如果内核缓冲区没有数据，那么进程就返回一个错误而**不会阻塞**住，之后**不断询问内核**数据是否就绪，也就是说会**一直占用CPU**；知道内核数据就绪后，并且再次收到了线程的询问，那么**内核**将数据拷贝到用户线程后返回结束。

### 各种IO模型的区别
* 所有IO操作都可以分成**两个阶段**
  * 等待数据准备就绪
  * 将数据从内核态拷贝到用户空间

* 所有的IO模型都是根据其实是根据它在上述**两个阶段的不同表现**(用户进程或者线程是否阻塞)来区分的!!!:
  * 在第**一**个阶段用户进程是否阻塞用来**区分阻塞/非阻塞**
  * 在第**二**个阶段用户是否阻塞用来**区分同步/异步**

阻塞IO：用户进程在第一个阶段堵塞，第二个阶段也阻塞，两个阶段**都阻塞**

非阻塞IO：用户进程在第一个阶段不阻塞，第二个阶段阻塞

异步IO：异步IO实际上是用户进程发起read操作之后，就会立刻收到一个返回，所以用户进程就可以去完成其他的工作，而不需要阻塞；直到数据准备就绪并且完成了从内核空间向用户空间拷贝的工作，这时用户进程会收到一个通知，告诉他read操作已完成，用户进程在两个阶段**都不会阻塞**

可以看到除了异步IO都不阻塞，其余IO都至少在第二个阶段阻塞，都是同步IO：




### 有限状态机编程

* 复杂流程：如果程序的自然流程是**结构化**的，即一步步**流水线**执行，无任何分支，那就是简单流程；否则就是**复杂流程**，比如有很多判断操作，不同的条件会执行不同的动作，跳转等等，这样的流程**不是结构化**的。

## IO多路转接

## 其他读写函数

## 存储映射IO

## 文件锁

